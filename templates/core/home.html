{% extends 'base.html' %}
{% load static %}

{% block title %}Haron Market{% endblock %}

{% block content %}
        <div class="first">
          <div class="container">
            <div class="first__content">
              <div class="title-1">Интернет-магазин ритуальных товаров</div>
              <div class="first__text">Станьте партнером в своем городе и продвигайте свои услуги, даже если у вас нет сайта!</div>
              <div class="first__img"><img src="{% static 'img/first.svg' %}" alt=""></div>
              <div class="first__action">
                <div class="_info">Оставьте заявку и получите инструкцию <br>по запуску похоронного бизнеса с нуля</div><a class="btn btn-primary" href="">Получить инструкцию</a>
              </div>
            </div>
            <div class="first__footer">
              <div class="_col">
                <div class="card-small">
                  <div class="_icon"><img src="{% static 'img/ben-1.svg' %}" alt=""></div>
                  <div class="_title">Все необходимое для бизнеса в одном месте</div>
                </div>
              </div>
              <div class="_col">
                <div class="card-small card-small--shadow">
                  <div class="_icon"><img src="{% static 'img/ben-2.svg' %}" alt=""></div>
                  <div class="_title">Портал — гарант качества между поставщиками и клиентами</div>
                </div>
              </div>
              <div class="_col">
                <div class="card-small">
                  <div class="_icon"><img src="{% static 'img/ben-3.svg' %}" alt=""></div>
                  <div class="_title">Размещайте и продавайте свою продукцию</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="container pt-md-5 pt-3">
          <div class="title-1 text-lg-center">Каталог</div>
          <div class="product-banner"> 
            <div class="product-banner__img"><img src="{% static 'img/item.svg' %}" alt=""></div>
            <div class="product-banner__title">Памятники со скидко 40%</div>
            <div class="product-banner__text">Бесплатная доставка без навязанных услуг и завышенных цен</div>
            <div class="product-banner__price">от 4 900 руб.</div>
            <div class="product-banner__info">Выезд агента бесплатно</div>
            <div class="product-banner__action"><a class="btn btn-primary" href="">Рассчитать стоимость</a></div>
          </div>
          <div>
            <ul class="nav nav-tabs">
              {% for item in categories_with_products %}
              <li class="nav-item">
                  <button class="nav-link {% if forloop.first %}active{% endif %}" data-bs-toggle="tab" data-bs-target="#mp-catalog-{{ item.category.id }}" type="button" role="tab">{{ item.category.name }}</button>
              </li>
              {% empty %}
              <li class="nav-item">
                  <span class="nav-link">Нет категорий</span>
              </li>
              {% endfor %}
            </ul>
            <div class="tab-content py-lg-5 py-md-4 py-2">
              {% for item in categories_with_products %}
              <div class="tab-pane fade {% if forloop.first %}active show{% endif %}" id="mp-catalog-{{ item.category.id }}" role="tabpanel">
                <form method="get" action="{% url 'catalog:catalog' %}" class="search">
                  <input class="form-control" type="text" name="q" placeholder="Поиск">
                  <button type="submit" class="search-btn"><img src="{% static 'img/search.svg' %}" alt=""></button>
                </form>
                <form method="get" action="{% url 'core:index' %}" class="sort-form">
                  <div class="sort my-1">
                    <div class="sort__text">Сортировать по:</div>
                    <label class="sort__label">
                      <input type="radio" name="sort" value="price_asc" {% if sort_by == 'price_asc' %}checked{% endif %} hidden onchange="this.form.submit()">
                      <div class="sort__label-text">По цене (дешевые)</div>
                    </label>
                    <label class="sort__label">
                      <input type="radio" name="sort" value="price_desc" {% if sort_by == 'price_desc' %}checked{% endif %} hidden onchange="this.form.submit()">
                      <div class="sort__label-text">По цене (дорогие)</div>
                    </label>
                    <label class="sort__label">
                      <input type="radio" name="sort" value="name" {% if sort_by == 'name' %}checked{% endif %} hidden onchange="this.form.submit()">
                      <div class="sort__label-text">По алфавиту</div>
                    </label>
                    <label class="sort__label">
                      <input type="radio" name="sort" value="date" {% if sort_by == 'date' or not sort_by %}checked{% endif %} hidden onchange="this.form.submit()">
                      <div class="sort__label-text">По дате (новые)</div>
                    </label>
                  </div>
                </form>
                <div class="row row-cols-xl-4 row-cols-md-3 row-cols-2">
                  {% for product in item.products %}
                  <div class="col">
                    <div class="card-product">
                      <div class="card-product__img">
                        <div>
                          {% if product.images.all %}
                            {% with main_image=product.images.all|first %}
                              <img src="{{ main_image.image.url }}" alt="{{ main_image.alt_text|default:product.name }}"/>
                            {% endwith %}
                          {% else %}
                            <img src="{% static 'img/item.svg' %}" alt="{{ product.name }}"/>
                          {% endif %}
                  </div>
                      </div>
                      <a class="card-product__title" href="{% url 'catalog:detail' product_id=product.id %}">{{ product.name }}</a>
                      <div class="card-product__price">
                        {% if product.discount_price %}
                          <nobr class="_old">{{ product.price|floatformat:2 }} руб.</nobr>
                          <nobr>от {{ product.discount_price|floatformat:2 }} руб.</nobr>
                        {% else %}
                          от {{ product.price|floatformat:2 }} руб.
                        {% endif %}
                      </div>
                    </div>
                  </div>
                  {% empty %}
                  <div class="col-12">
                    <div class="alert alert-info">В этой категории пока нет товаров.</div>
                  </div>
                  {% endfor %}
                </div>
                <div class="text-center"><a class="btn btn-primary" href="{% url 'catalog:catalog' %}">Посмотреть всё</a></div>
              </div>
              {% empty %}
              <div class="tab-pane fade active show" id="mp-catalog-empty" role="tabpanel">
                <div class="alert alert-info">Товары пока не добавлены в каталог.</div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
        <script>
          // Обработка клика по label для скрытых radio buttons на главной странице
          document.querySelectorAll('.sort-form .sort__label').forEach(function(label) {
            label.addEventListener('click', function(e) {
              var radio = this.querySelector('input[type="radio"]');
              if (radio && !radio.checked) {
                radio.checked = true;
                radio.dispatchEvent(new Event('change'));
              }
            });
          });
        </script>
        <div class="bg-gradient-2 text-center py-3 my-md-4 my-2">
          <div class="container">
            <div class="title-2 mt-0">Станьте партнером в своем городе и получайте<br class="d-none d-lg-inline"> клиентов, даже если у вас нет сайта</div>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#order-partner">Стать партнером</button>
          </div>
        </div>
        <div class="container"> 
          <div class="title-1 text-lg-center">Какие это дает преимущества для вас?</div>
          <div class="row align-items-center my-3 my-md-6 my-lg-6 my-xl-8 flex-lg-row-reverse">
            <div class="col-lg-5">
              <div class="px-xl-2">
                <div class="title-3 mb-05">Отсутствие конкурентов <br><span class="text-blue">в вашем городе</span></div>
                <p>На нашем портале действует строгое правило: 1 партнер на весь город. Это значит, что если вы планируете продавать станки или памятники, то на нашем портале в вашем городе у вас не будет конкурентов. Вы полностью занимаете этот раздел и все клиенты достаются вам. Две разных компании не смогут разместить свои услуги/товары на портале. </p>
                <p>Успейте стать первым!</p>
              </div>
            </div>
            <div class="col-lg-7 text-center my-2"><img src="{% static 'img/benefit-1.svg' %}" alt=""></div>
          </div>
          <div class="row align-items-center my-3 my-md-6 my-lg-6 my-xl-8">
            <div class="col-lg-5">
              <div class="px-xl-2">
                <div class="title-3 mb-05">Есть все, что нужно для продаж<br><span class="text-blue"> и без дополнительных затрат </span></div>
                <p>Вам не нужно вкладывать сотни тысяч в разработку сайта, настройку рекламы и поиск необходимых специалистов. Размещайте и продавайте свою продукцию или услуги, а портал будет выступать в роли гаранта качества. </p>
                <p>Портал берет на себя ответственность за рекламу, трафик и продвижение ваших услуг, а так же стабильную и бесперебойную работу интернет – магазина. </p>
              </div>
            </div>
            <div class="col-lg-7 text-center my-2"><img src="{% static 'img/benefit-2.svg' %}" alt=""></div>
          </div>
          <div class="row align-items-center my-3 my-md-6 my-lg-6 my-xl-8 flex-lg-row-reverse">
            <div class="col-lg-5">
              <div class="px-xl-2">
                <div class="title-3 mb-05"> Все необходимое для бизнеса <br><span class="text-blue">в одном месте</span></div>
                <p>Все необходимые товары для бизнеса вы сможете найти на портале: от расходных материалов до гравировальных станков. А для тех, кто еще на старте мы подготовили специальную инструкцию "Как начать похоронный бизнес с нуля"</p>
                <p>Все партнеры проходят строгий отбор, поэтому покупать и продавать на портале не только безопасно, но зачастую и крайне выгодно.</p>
              </div>
            </div>
            <div class="col-lg-7 text-center my-2"><img src="{% static 'img/benefit-3.svg' %}" alt=""></div>
          </div>
        </div>
        <div class="bg-blue-dark text-center py-3 my-5">
          <div class="container">
            <div class="row align-items-center justify-content-center">
              <div class="col-auto">
                <div class="title-2 my-1 text-white">Успейте стать первым <span class="text-blue">в вашем городе!</span></div>
              </div>
              <div class="col-auto">
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#order-partner">Стать партнером</button>
              </div>
            </div>
          </div>
        </div>
        <div class="container"> 
          <div class="title-1 text-lg-center">Как стать партнером?</div>
          <div class="title-3 text-lg-center">4 простых шага!</div>
          <div class="row row-cols-lg-4 row-cols-md-2 row-cols-1 my-md-4 my-3">
            <div class="col partner-step pe-lg-4 my-md-2 my-1">
              <div class="partner-step__img">
                <div class="_num">1</div><img src="{% static 'img/step-1.svg' %}" alt="">
              </div>
              <div class="partner-step__title">Заявка</div>
              <div class="partner-step__text">Оставляете заявку, где указываете информацию о себе и желаемую позицию</div>
            </div>
            <div class="col partner-step pe-lg-4 my-md-2 my-1">
              <div class="partner-step__img">
                <div class="_num">2</div><img src="{% static 'img/step-2.svg' %}" alt="">
              </div>
              <div class="partner-step__title">Звонок</div>
              <div class="partner-step__text">С вами созванивается модератор портала и после успешного обсуждения и выбора позиции вы получаете доступ к личному кабинету</div>
            </div>
            <div class="col partner-step pe-lg-4 my-md-2 my-1">
              <div class="partner-step__img">
                <div class="_num">3</div><img src="{% static 'img/step-3.svg' %}" alt="">
              </div>
              <div class="partner-step__title">Добавление товара</div>
              <div class="partner-step__text">Добавляете информацию о товаре и компании, выбираете подходящий тариф и товар размещается на главной странице портала</div>
            </div>
            <div class="col partner-step pe-lg-4 my-md-2 my-1">
              <div class="partner-step__img">
                <div class="_num">4</div><img src="{% static 'img/step-4.svg' %}" alt="">
              </div>
              <div class="partner-step__title">Готово</div>
              <div class="partner-step__text">И вы начинаете зарабатывать с помощью нашего портала!</div>
            </div>
          </div>
        </div>
        <div class="container">
          <div class="title-1 text-center">Тарифы по продвижению товаров и услуг</div>
          <p class="text-center mt-1">Товар размещается на главном портале <br> и начинает продвигаться согласно выбранному тарифу </p>
          <div class="row justify-content-center my-md-2">
            <div class="col-auto"><a class="card-tarif my-md-2 my-1" href="">
                <div class="card-tarif__img"><img src="{% static 'img/tarif-1.svg' %}" alt=""></div>
                <div class="card-tarif__period">3 месяца</div>
                <div class="card-tarif__price">5 000 р</div></a></div>
            <div class="col-auto"><a class="card-tarif my-md-2 my-1" href="">
                <div class="card-tarif__img"><img src="{% static 'img/tarif-2.svg' %}" alt=""></div>
                <div class="card-tarif__period">1 год</div>
                <div class="card-tarif__price">10 000 р</div></a></div>
          </div>
          <div class="text-center mb-2">
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#order-partner">Оставить заявку на партнерство</button>
          </div>
          <p class="text-center">Для размещения своего товара, оставьте заявку<br>  и выберите подхдоящих тариф</p>
        </div>
{% endblock %}

{% block modals %}
    {% include 'includes/modal-partner.html' %}
    <div class="modal fade" tabindex="-1" aria-labelledby="pay-success" aria-hidden="true" id="pay-success">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <form class="modal-body p-md-3">
            <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
            <div class="title-3 mb-2">Оплата прошла успешно!</div>
            <p>Вся информация о заказе отправлена вам на почту. В ближайшее время с вами свяжется поставщик.</p>
            <p>Если будут вопросы - звоните нам!</p><a class="fs-5" href="tel: 8 800 800 80 00"><img class="me-1" src="{% static 'img/phone.svg' %}" alt="">8 800 800 80 00</a>
          </form>
        </div>
      </div>
    </div>
    <div class="modal fade" tabindex="-1" aria-labelledby="account-settings" aria-hidden="true" id="account-settings">
      <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
          <div class="modal-body">
            <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
            <div class="title-2 mt-0 mb-2">Настройки</div>
            <ul class="nav nav-tabs">
              <li class="nav-item">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#account-settings-tab-1" type="button" role="tab">Основная информация</button>
              </li>
              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#account-settings-tab-2" type="button" role="tab">Информация о компании</button>
              </li>
              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#account-settings-tab-3" type="button" role="tab">Безопасность</button>
              </li>
              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#account-settings-tab-4" type="button" role="tab">Подписка и аккаунт</button>
              </li>
            </ul>
            <div class="tab-content py-2">
              <div class="tab-pane fade active show" role="tabpanel" id="account-settings-tab-1">
                <form>
                  <div class="row row-cols-lg-3 row-cols-md-2 row-cols-1">
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">Фамилия*</p>
                        <input class="form-control" type="text" value="" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">Имя *</p>
                        <input class="form-control" type="text" value="Евгения" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">Отчество *</p>
                        <input class="form-control" type="text" value="Сергеевна" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">Номер телефона *</p>
                        <input class="form-control" type="tel" value="+7 (908) 667-78-76" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">E-mail*</p>
                        <input class="form-control" type="email" value="pochta@gmail.com" required>
                      </label>
                    </div>
                  </div>
                  <div class="mt-2">
                    <button class="btn btn-outline-primary">Сохранить</button>
                  </div>
                </form>
              </div>
              <div class="tab-pane fade" role="tabpanel" id="account-settings-tab-2">
                <form>
                  <div class="row row-cols-lg-3 row-cols-md-2 row-cols-1">
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">Название компании*</p>
                        <input class="form-control" type="text" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">ИНН *</p>
                        <input class="form-control" type="text" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">Город *</p>
                        <input class="form-control" type="text" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">Рабочий телефон *</p>
                        <input class="form-control" type="tel" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">E-mail*</p>
                        <input class="form-control" type="email" required>
                      </label>
                    </div>
                    <div class="col">
                      <label class="mb-1">
                        <p class="form-label form-label--small">Р/С *</p>
                        <input class="form-control" type="text" required>
                      </label>
                    </div>
                  </div>
                  <div class="mt-2">
                    <button class="btn btn-outline-primary">Сохранить</button>
                  </div>
                </form>
              </div>
              <div class="tab-pane fade" role="tabpanel" id="account-settings-tab-3">
                <form class="needs-validation" novalidate>
                  <label class="mb-1">
                    <p class="form-label form-label--small">Старый пароль *</p>
                    <input class="form-control" type="password" required>
                    <div class="invalid-feedback">Неверно введен пароль</div>
                  </label>
                  <label class="mb-1">
                    <p class="form-label form-label--small">Новый пароль *</p>
                    <input class="form-control" type="password" required>
                  </label>
                  <label class="mb-1">
                    <p class="form-label form-label--small">Повтор пароля *</p>
                    <input class="form-control" type="password" required>
                    <div class="invalid-feedback">Пароли не совпадают</div>
                  </label>
                  <div class="mt-2">
                    <button class="btn btn-outline-primary">Сохранить</button>
                  </div>
                </form>
              </div>
              <div class="tab-pane fade" role="tabpanel" id="account-settings-tab-4">
                <div class="alert alert-primary alert-dismissible fade show" role="alert">
                  <div class="text-center">Ваш тарифный план: Мегаплан. Тариф оплачен до: 27.02.2021. </div>
                  <button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                  <div class="text-center">Ваш тариф закончился. Для продолжения выберите и оплатите тариф из списка.</div>
                </div>
                <div class="alert alert-warning alert-dismissible fade show" role="alert">
                  <div class="row align-items-center">
                    <div class="col">
                      <div class="text-center">Ваша подписка скоро закончится. Тариф оплачен до: 27.02.2021.</div>
                    </div>
                    <div class="col-auto"><a class="btn btn-danger btn-sm" href="">Оплатить</a></div>
                  </div>
                </div>
                <div class="row justify-content-end my-2">
                  <div class="col-auto">
                    <div class="form-check form-switch">
                      <input class="form-check-input" id="flexSwitchCheckChecked38049756" type="checkbox" checked>
                      <label class="form-check-label" for="flexSwitchCheckChecked38049756">Автопродление</label>
                    </div>
                  </div>
                </div>
                <div class="title-3 mb-2">Тарифы</div>
                <div class="card-line"> 
                  <div class="card-line__row align-items-center">
                    <div class="card-line__col">1 месяц <strong>Мегаплан</strong></div>
                    <div class="card-line__col-auto">800 руб</div>
                    <div class="card-line__col-auto"><a class="btn btn-success btn-sm" href="">Оплатить </a></div>
                  </div>
                </div>
                <div class="card-line"> 
                  <div class="card-line__row align-items-center">
                    <div class="card-line__col">1 месяц <strong>Мегаплан</strong></div>
                    <div class="card-line__col-auto">800 руб</div>
                    <div class="card-line__col-auto"><a class="btn btn-success btn-sm" href="">Оплатить </a></div>
                  </div>
                </div>
                <div class="card-line"> 
                  <div class="card-line__row align-items-center">
                    <div class="card-line__col">1 месяц <strong>Мегаплан</strong></div>
                    <div class="card-line__col-auto">800 руб</div>
                    <div class="card-line__col-auto"><a class="btn btn-success btn-sm" href="">Оплатить </a></div>
                  </div>
                </div>
                <div class="card-line bg-primary">
                  <div class="card-line__row align-items-center">
                    <div class="card-line__col text-white">1 месяц <strong>Мегаплан</strong></div>
                    <div class="card-line__col-auto text-white">800 руб</div>
                    <div class="card-line__col-auto"><a class="btn btn-success btn-sm" href="">Оплатить </a></div>
                  </div>
                </div>
                <div class="card-line bg-success">
                  <div class="card-line__row align-items-center">
                    <div class="card-line__col text-white">1 месяц <strong>Мегаплан</strong></div>
                    <div class="card-line__col-auto text-white">800 руб</div>
                    <div class="card-line__col-auto"><a class="btn btn-primary btn-sm" href="">Оплатить </a></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="js/index.js"></script>
{% endblock %}
